'use strict';(function(a){var p=!1,q=function(c,b){var g=c.length-1;a.ajax({url:ajaxurl,type:"POST",dataType:"json",data:{action:"ptb_search_set_values",data:c[b]},success:function(e){var d=a(a("form.ptb-search-form")[b]),f;for(f in e)if(e[f].min){var l=Math.floor(e[f].min),h=Math.floor(e[f].max),k=a("#"+f+"_min"),m=a("#"+f+"_max");!k.val()&&k.val(l);!m.val()&&m.val(h);k.attr("min",l);m.prop("max",h)}else for(var n in e[f])a("#"+f+"_"+e[f][n]).length?a("#"+f+"_"+e[f][n]).prop("disabled",!0).closest("label").addClass("ptb-search-disabled"):
a("#"+f).is("select")&&a("#"+f).find('option[value="'+e[f][n]+'"]').prop("disabled",!0).end().trigger("chosen:updated");t(d);g>b&&q(c,++b)}})},t=function(c){a.fn.slider&&c.find(".ptb-search-slider").each(function(){var b=a(this).closest(".ptb_search_wrap_number"),g=b.find(".ptb_search_number_max"),e=b.find(".ptb_search_number_min");b=parseInt(e.prop("min"));var d=parseInt(g.prop("max")),f=parseInt(e.val()),l=parseInt(g.val());isNaN(b)||isNaN(d)||a(this).slider({range:!0,min:b,step:1,max:d,values:[f,
l],slide:function(h,k){e.val(k.values[0]);g.val(k.values[1]);h=a(this).find(".ptb-search-slider-tooltip-inner");h.first().html(k.values[0]);h.last().html(k.values[1])},stop:function(h,k){h=c.closest(".ptb-search-form");h.hasClass("ptb-search-no-ajax")||h.find('input[type="submit"]').length||h.trigger("submit")},create:function(h,k){h='<span class="ptb-search-slider-tooltip"><span class="ptb-search-slider-tooltip-inner">'+f+'</span><span class="ptb-search-slider-tooltip-arrow"></span></span>';k=a(this).children(".ui-slider-handle");
k.first().html(h);k.last().html(h.replace(f,l))}})})},u=function(){a(".ptb-search-autocomplete").each(function(){var c=a(this),b=c.data("post_type"),g=[];g[b]=[];c.autocomplete({minLength:2,source:function(e,d){var f=a.trim(e.term);2>f.length||(f=f.toLowerCase(),f in g[b]?d(g[b][f]):(e.action="ptb_search_autocomplete",e.key=c.data("key"),a.getJSON(ajaxurl,e,function(l,h,k){for(const n in l){h=l[n];k=l[n].label;var m=document.createElement("textarea");m.innerHTML=k;h.label=m.innerText}g[b][f]=l;d(l)})))},
select:function(e,d){c.val(d.item.value);c.next("input").val(d.item.id);return!1}}).focus(function(){a(this).autocomplete("search")}).autocomplete("widget").addClass("ptb-search-autocomplete-dropdown")})},w=function(){a("body").on("submit",".ptb-search-form:not(.ptb-search-no-ajax)",function(c){c.preventDefault();var b=a(this);c=b.find(".ptb-search-post-type").val();var g=b.find('input[name="f"]').val(),e=b.serialize();let d=a(".ptb-search-shortcode-placeholder").first();d.length||(d=a('.ptb_loops_wrapper[data-type="'+
c+'"]').first());d.length||(d=a(".ptb-search-container:not(.ptb-search-shortcode-placeholder)").first());d.length||(0<a("article.ptb_post").length?(a("article.ptb_post").first().after('<div class="ptb-search-container" style="display: none;"></div>'),d=a(".ptb-search-container")):d=a(".post").first());b.find('input[name="p"]').val("");a.ajax({url:ptb_search.ajaxurl+"?action=ptb_ajax_search",data:e,type:"POST",beforeSend:function(){b.addClass("ptb-search-submit");d.addClass("ptb-search-wait")},complete:function(){b.removeClass("ptb-search-submit");
d.removeClass("ptb-search-wait")},success:function(f){f&&(!b.hasClass("ptb-search-exclude-pageclear")&&0<d.siblings().length&&d.siblings().not(".ptb-search-container,form.ptb-search-form").remove(),d.show(),d[0].classList.contains("ptb_loops_wrapper")&&f.includes("ptb_loops_wrapper")&&a(f)[0].classList.contains("ptb_loops_wrapper")?d.replaceWith(f):d.html(f),b.hasClass("ptb-search-no-scroll")||v(d),p=g,history.pushState({},null,"?"+e),a(window).on("popstate",function(l){location.reload()}),"undefined"!=
typeof window.wp&&"undefined"!=typeof window.wp.mediaelement&&window.wp.mediaelement.initialize(),a(document).trigger("ptb_loaded",!1))}})})},x=function(){a("body").on("click",".ptb-search-container .ptb_pagenav a",function(c){var b=a(".ptb-search-"+p);if(0<b.length){c.preventDefault();c=b.find('input[name="ptb_page"]');var g=c.val,e=a(this),d=parseInt(e.text());d||(d=parseInt(e.closest(".ptb_pagenav").find(".current").text()),e.hasClass("next")?++d:--d);g.call(c,d);b.submit()}})},v=function(c){if(0<
c.length){c=c.offset().top-10;let b=a("#wpadminbar");b.length&&(c-=b.outerHeight(!0));a("html,body").animate({scrollTop:c},1E3)}},r=function(){if(a.timepicker){var c={showOn:"focus",showButtonPanel:!0,showHour:1,showMinute:1,timeOnly:!1,showTimepicker:!1,buttonText:!1,dateFormat:"yy-mm-dd",timeFormat:"hh:mm tt",stepMinute:5,separator:"@",minInterval:0,beforeShow:function(){a("#ui-datepicker-div").addClass("ptb_search_datepicker")},onClose:function(b,g){}};a(".ptb_search_field_date input").each(function(){var b=
a(this).data("id");b&&(b=a("#"+b+"_end"),a(this).data("time")&&(c.showTimepicker=1),a.timepicker.datetimeRange(a(this),b,c))})}};window.addEventListener("load",function(){a("body").on("change",".ptb-search-form select, .ptb-search-form input, .ptb-search-form textarea",function(){var e=a(this).closest(".ptb-search-form");e.hasClass("ptb-search-no-ajax")||e.find('input[type="submit"]').length||e.trigger("submit")});a.fn.select2&&a("form.ptb-search-form").find("select").select2({width:"100%"});u();
var c=[],b=a("form.ptb-search-form"),g=a(".ptb-search-container:not(.ptb-search-shortcode-placeholder)");0>=b.length&&0>=g.children().length?g.remove():b.each(function(e){c[e]=a(this).find(".ptb_search_keys").val()});0<g.siblings().length&&0<g.children().length&&!g.hasClass("ptb-search-exclude-pageclear")&&g.siblings().not(".ptb-search-container, form.ptb-search-form").remove();"undefined"!==typeof window.ptb_searched_slug&&(p=window.ptb_searched_slug);"ontouchstart"in window||0<navigator.MaxTouchPoints||
0<navigator.msMaxTouchPoints?PTB.LoadAsync(ptb_search.url+"js/jquery.ui.touch-punch.min.js",function(){r();q(c,0)},null,ptb_search.ver):(q(c,0),r());w();x()},{once:!0,passive:!0})})(jQuery);
